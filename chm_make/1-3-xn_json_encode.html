<!DOCTYPE html>
<html>
<head>
	<title>xn_json_encode()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="XiunoPHP 开发手册" />
	<meta name="description" content="XiunoPHP 开发手册 " />
	<meta name="generator" content="Xiuno BBS" />
	<meta name="author" content="Xiuno Team" />
	<meta name="copyright" content="2008-2015 xiuno.com" />
	<link href="xiunoui/xiuno.css" type="text/css" rel="stylesheet" />
	<link href="xiunoui/icon.css" type="text/css" rel="stylesheet" />
	<link href="syntaxhighlighter_3.0.83/shCoreRDark.css" type="text/css" rel="stylesheet" />
	<link href="chm.css" type="text/css" rel="stylesheet" />
</head>
<body>

<h3>xn_json_encode($arg)</h3>

<hr>

<pre>
对变量进行 JSON 编码，不对中文进行 UNICODE 转义。
</pre>

<b>【定义】</b> 文件：xiunophp/xiunophp.php 大约 798 行：

<pre class="brush:php">
function xn_json_encode($arg) {
	$r = '';
	switch (gettype($arg)) {
		case 'array':
			$r = is_number_array($arg) ? xn_json_number_array_to_string($arg) : xn_json_assoc_array_to_string($arg);
		break;
		case 'object':
			return xn_json_encode(get_object_vars($arg));
		break;
		case 'integer':
		case 'double':
			$r = is_numeric($arg) ? (string)$arg : 'null';
		break;
		case 'string':
		$r = '"' . strtr($arg, array(
			"\r"   => '\\r',    "\n"   => '\\n',    "\t"   => '\\t',     "\b"   => '\\b',
			"\f"   => '\\f',    '\\'   => '\\\\',   '"'    => '\"',
			"\x00" => '\u0000', "\x01" => '\u0001', "\x02" => '\u0002', "\x03" => '\u0003',
			"\x04" => '\u0004', "\x05" => '\u0005', "\x06" => '\u0006', "\x07" => '\u0007',
			"\x08" => '\b',     "\x0b" => '\u000b', "\x0c" => '\f',     "\x0e" => '\u000e',
			"\x0f" => '\u000f', "\x10" => '\u0010', "\x11" => '\u0011', "\x12" => '\u0012',
			"\x13" => '\u0013', "\x14" => '\u0014', "\x15" => '\u0015', "\x16" => '\u0016',
			"\x17" => '\u0017', "\x18" => '\u0018', "\x19" => '\u0019', "\x1a" => '\u001a',
			"\x1b" => '\u001b', "\x1c" => '\u001c', "\x1d" => '\u001d', "\x1e" => '\u001e',
			"\x1f" => '\u001f'
			)) . '"';
		break;
		case 'boolean':
			$r = $arg ? 1 : 0;
		break;
		default:
			$r = 'null';
	}
	return $r;
}
</pre>

<br><b>【用例】</b>
<pre class="brush:php">
&lt;?php

$conf = include './conf.php';
include './xiunophp/xiunophp.php';

$arr = array ('name'=>'中文');
$s = xn_json_encode($arr);
echo $s; // {"name": "中文"}


?&gt;
</pre>

</body>
</html>
<script src="xiunoui/jquery-1.11.1.js"></script>
<script src="xiunoui/async.js"></script>
<script src="xiunoui/md5.js"></script>
<script src="xiunoui/xiuno.js"></script>
<script src="xiunoui/dialog.js"></script>
<script src="syntaxhighlighter_3.0.83/shCore.js"></script>
<script src="syntaxhighlighter_3.0.83/shBrushJScript.js"></script>
<script src="syntaxhighlighter_3.0.83/shBrushPhp.js"></script>
<script>
SyntaxHighlighter.defaults['tab-size'] = 8;
SyntaxHighlighter.all();
</script>

